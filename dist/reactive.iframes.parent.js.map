{"version":3,"sources":["reactive.iframes.parent.ts"],"names":[],"mappings":"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","file":"reactive.iframes.parent.js","sourcesContent":["\nmodule reactive.iframes {\n    \n    const MessagePrefix = 'ReactiveIFrames';\n    const MessageDelimiter = '~';\n\n    export class Parent {\n\n        url: string\n        config: any\n        messageRegex: RegExp\n\n        constructor(private element: HTMLElement, private id: string, private addHeight?: number) {\n            window.addEventListener('resize', this.onResize);\n            this.messageRegex = new RegExp('^' + MessagePrefix + MessageDelimiter + id + MessageDelimiter + '(\\\\S+)' + MessageDelimiter + '(.+)$');\n            window.addEventListener('message', this.processMessage.bind(this), false);\n        }\n        \n        private onResize = (event: Event) => {\n            this.sendWidth();\n        }\n\n        sendWidth() {\n            var width = this.element.offsetWidth.toString();\n            this.sendMessage('width', width);\n        }\n\n        sendMessage(messageType: string, message: string) {\n            this.iframe.contentWindow.postMessage(this.makeMessage(messageType, message), '*');\n        }\n\n        private makeMessage(messageType: string, message: string) {\n            var bits = [MessagePrefix, this.id, messageType, message];\n            return bits.join(MessageDelimiter);\n        }\n\n        get iframe() {\n            return this.element.getElementsByTagName('iframe')[0];\n        }\n\n        processMessage(event: Event) {\n            if (!(event instanceof MessageEvent) || typeof <MessageEvent>event.data !== 'string') {\n                return;\n            }\n            var messageData = <string>(<MessageEvent>event).data;\n\n            var match = messageData.match(this.messageRegex);\n            if (!match || match.length !== 3) { return; }\n\n            var key = match[1];\n            var value = match[2];\n            if (key === 'height') {\n                var height = parseInt(value);\n                if (this.addHeight) {\n                    height += this.addHeight;\n                }\n                //console.log(\"Child -> \" + height + \" H Parent (\" + this.id + \")\");\n                this.iframe.setAttribute('height', height + 'px');\n            }\n        }\n    }\n\n}"]}